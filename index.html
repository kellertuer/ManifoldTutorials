<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/libs/katex/katex.min.css"> <link rel=icon  href="/ManifoldTutorials/assets/favicon/favicon.ico"> <link rel=stylesheet  href="/ManifoldTutorials/libs/cosmo/bootstrap.min.css"> <link rel=stylesheet  href="/ManifoldTutorials/css/manifolds.css"> <link rel=stylesheet  href="/ManifoldTutorials/libs/highlight/atelier-seaside-light-mod.css"> <title>Manifold Tutorials</title> <nav class="navbar navbar-expand-lg navbar-light bg-light"> <a class=navbar-brand  href="#">Manifold Tutorials</a> <button class=navbar-toggler  type=button  data-toggle=collapse  data-target="#navbarColor02" aria-controls=navbarColor02  aria-expanded=false  aria-label="Toggle navigation"> <span class=navbar-toggler-icon ></span> </button> <div class="collapse navbar-collapse" id=navbarColor02 > <ul class="navbar-nav mr-auto"> <li class="nav-item active"> <a class=nav-link  href="#">Start</a> <li class=nav-item > <a class=nav-link  href="#">A Riemannian manifold</a> </ul> </div> </nav> <div class=container-sm > <!-- closed in foot--> <h1>Manifold Tutorials</h1> <div class=franklin-content ><div class=row > <div class="col-sm text-to-code"> <h2 id=the_rayleigh_quotient ><a href="#the_rayleigh_quotient">The Rayleigh Quotient</a></h2> <p>For a symmetric matrix, i.e. \(A∈\mathbb R^{n\times n}, A = A^\mathrm{T}\), the Rayleigh quotient is defined as</p> \[ f(x) = \frac{x^\mathrm{T} A x}{\lVert x \rVert^2}. \] <p>It can be used to compute an <a href="https://en.wikipedia.org/wiki/Eigenvalues_and_eigenvectors">eigenvector</a> to the largest eigenvalue of a matrix. Let \(\lambda_1\) denote the largest eigenvalue. Then we have</p> \[ \lambda_1 = \max_{x\in\mathbb R^n} f(x). \] <p>Since optimization problems are usually phrased as minimization problems, we look at</p> \[ \min_{x\in\mathbb R^n} -f(x). \] <p>Still, Optimization on the whole Euclidean space has the problem, that the minimizer \(x^*\), where this minimum is attained, is not unique. This can easily be seen by observing that any \(a\cdot x\), with a positive \(a>0\) has the same function value, and also any such vector is of course also an eigenvector to \(\lambda_1\).</p> <p>A remedy is, to restrict the function \(f\) to all unit vectors, or in other words the unit sphere</p> \[ \mathbb S^{n-1} := \bigl\{x\in\mathbb R^n \big| \lVert x \rVert = 1 \bigr\} \] <p>of dimension \(n-1\). The code on the left now formulates the cost function and its gradient on this Riemannian manifold in order to perform a Riemannian <a href="https://en.wikipedia.org/wiki/Quasi-Newton_method">Quasi Newton</a> method.</p> <div class="alert alert-dismissible alert-primary"> <strong> Note</strong> In <code class=plaintext >Manopt.jl</code> the example is written using the Riemannian gradient. In <code class=plaintext >Manopt</code> the Euclidean gradient, that is the gradient in the embedding of the sphere, is provided and internally converted via projection to the Riemannian one. </div> <p></div> <div class=col-sm > <div class=bs-component > <ul class="nav nav-tabs" id=ManifoldTab0  role=tablist > <li class=nav-item > <a class="nav-link active" data-toggle=tab  href="#Julia0" aria-selected=true > <img class='icon' src='assets/icons/julia_src.png'/>Manopt.jl </a> <li class=nav-item > <a class=nav-link  data-toggle=tab  href="#Matlab0" aria-selected=false > <img class='icon' src='assets/icons/matlab_src.png'/>Manopt </a> <li class=nav-item > <a class=nav-link  data-toggle=tab  href="#Pymanopt0" aria-selected=false > <img class='icon' src='assets/icons/python_src.png'/>Pymanopt </a> <li class=nav-item > <a class=nav-link  data-toggle=tab  href="#Geomstats0" aria-selected=false > <img class='icon' src='assets/icons/python_src.png'/>GeomStats </a> </ul> <div class=tab-content  id=ManifoldConent0 > <div class="tab-pane fade show active" id=Julia0  role=tabpanel > <pre><code class=hightlight-julia >
using Manopt, Manifolds, Random, LinearAlgebra
# Generate random problem data.
n = 1000
A = randn(n, n)
A = (A + A') / 2

# Create the problem structure.
M = Sphere(n - 1)

# Define the problem cost function and its Riemannian gradient.
F(X) = -X' * A * X
∇F(X) = -2 * (A * X - X * X' * A * X)

# Solve
x = random_point(M)
quasi_Newton(M, F, ∇F, x; debug=[:Iteration, " ", :Cost, "\n", 1, :Stop])

</code></pre> </div> <div class="tab-pane fade" id=Matlab0  role=tabpanel > <pre><code class=hightlight-matlab >
% Generate random problem data.
n = 1000;
A = randn(n);
A = .5 * (A + A.');

% Create the problem structure.
manifold = spherefactory(n);
problem.M = manifold;

% Define the problem cost function and its Euclidean gradient.
problem.cost = @(x) -x' * (A * x);
problem.egrad = @(x) -2 * A * x; % notice the 'e' in 'egrad' for Euclidean

% Solve.
[x, xcost, info, options] = trustregions(problem);

</code></pre> </div> <div class="tab-pane fade" id=Pymanopt0  role=tabpanel > <pre><code class=hightlight-python >
import autograd.numpy as np

from pymanopt.manifolds import Stiefel
from pymanopt import Problem
from pymanopt.solvers import SteepestDescent

</code></pre> </div> <div class="tab-pane fade" id=Geomstats0  role=tabpanel > <pre><code class=hightlight-python >
import matplotlib
import matplotlib.image as mpimg
import matplotlib.pyplot as plt

import geomstats.visualization as visualization

visualization.tutorial_matplotlib()

</code></pre> </div> </div> </div> </div> </div> </p> <div class=page-foot > <div class=copyright > <p xmlns:dct="http://purl.org/dc/terms/" xmlns:cc="http://creativecommons.org/ns#" class=license-text > This work by <a rel="cc:attributionURL dct:creator" property="cc:attributionName" href="https://ronnybergmann.net/ManifoldTutorials/">Ronny Bergmann</a> is licensed under <a rel=license  href="https://creativecommons.org/licenses/by-nc-sa/4.0"> CC BY-NC-SA 4.0<img style="height:18px!important;margin-left:2px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1" /><img style="height:18px!important;margin-left:2px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1" /><img style="height:18px!important;margin-left:2px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/nc.svg?ref=chooser-v1" /><img style="height:18px!important;margin-left:2px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/sa.svg?ref=chooser-v1" /></a>. <br /> Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>. </p> </div> </div> </div> </div> <script src="/ManifoldTutorials/libs/jQuery/jquery-3.5.1.min.js"></script> <script src="/ManifoldTutorials/libs/bootstrap/js/bootstrap.bundle.min.js"></script> <script src="/ManifoldTutorials/libs/highlight/highlight.pack.js"></script> <script src="/ManifoldTutorials/libs/katex/katex.min.js"></script> <script src="/ManifoldTutorials/libs/katex/auto-render.min.js"></script> <script>hljs.initHighlightingOnLoad();hljs.configure({tabReplace: ' '});</script> <script>renderMathInElement( document.body, { delimiters: [ {left: "$$", right: "$$", display: true}, {left: "\\[", right: "\\]", display: true}, {left: "$", right: "$", display: false}, {left: "\\(", right: "\\)", display: false} ] } ); </script>